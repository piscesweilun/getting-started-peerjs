<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PeerJS Sender</title>
    <script src="https://unpkg.com/peerjs@1.3.1/dist/peerjs.min.js"></script>
</head>
<body>
    <h1>Sender</h1>
    <h2 id="peer-id">Peer ID</h2>
    <h3 id="message">No message yet.</h3>

    <button type="button" onclick="onSendMessage()">Send</button>

    <script>
      var peer = new Peer('24717268-sender', {

        // 伺服器放在 local
        //host: 'localhost',
        //proxied: true,

        // 伺服器放在 Google cloud
        host: '130.211.246.15',

        port: 9000,
        path: '/myapp',
      });
      peer.on('open', function(id) {
        console.log('My peer ID is: ' + id);
        document.getElementById('peer-id').innerHTML = "Peer ID = " + id;
      });

      peer.on('close', function() {
        console.log("closed")
      });

      peer.on('disconnected', function() {
        console.log("disconnected");
      });

      var conn = peer.connect('24717268-receiver');
      conn.on('open', function() {
        // Receive messages
        conn.on('data', function(data) {
          console.log('Received', data);
          document.getElementById('message').innerHTML = "Received: " + data;
        });
        // Send messages
        conn.send("Hello! I'm sender");
      });

      function onSendMessage() {
        console.log("Message sent...");
        conn.send("Buttn clicked from sender");
      }
    </script>
</body>
</html>
